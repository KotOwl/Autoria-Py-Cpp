<!-- FILE: frontend/templates/edit_listing.html -->
<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è - AutoRia Clone</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .navbar {
            background: white;
            padding: 15px 30px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .navbar h1 {
            color: #667eea;
            font-size: 24px;
        }
        .nav-links {
            display: flex;
            gap: 15px;
            align-items: center;
        }
        .nav-links a {
            color: #667eea;
            text-decoration: none;
        }
        .container {
            max-width: 800px;
            margin: 30px auto;
            padding: 0 20px;
        }
        .form-card {
            background: white;
            border-radius: 10px;
            padding: 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-group label {
            display: block;
            margin-bottom: 5px;
            color: #333;
            font-weight: 500;
        }
        .form-group input,
        .form-group select,
        .form-group textarea {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        .form-group textarea {
            min-height: 100px;
            resize: vertical;
        }
        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            text-decoration: none;
            display: inline-block;
        }
        .btn-primary {
            background: #667eea;
            color: white;
        }
        .btn-primary:hover {
            background: #5568d3;
        }
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        .error {
            background: #fee;
            color: #c33;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <nav class="navbar">
        <h1><a href="/" style="color: #667eea; text-decoration: none;">üöó AutoRia Clone</a></h1>
        <div class="nav-links">
            <a href="/">–ì–æ–ª–æ–≤–Ω–∞</a>
            <a href="/my-listings">–ú–æ—ó –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</a>
            <a href="/profile">–ü—Ä–æ—Ñ—ñ–ª—å</a>
        </div>
    </nav>

    <div class="container">
        <div class="form-card">
            <h2 style="margin-bottom: 20px; color: #333;">–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è</h2>
            
            {% if error %}
            <div class="error">{{ error }}</div>
            {% endif %}
            
            {% if listing.editCount >= 3 %}
            <div class="warning">
                –£–≤–∞–≥–∞! –í–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–ª–∏ –≤—Å—ñ 3 —Å–ø—Ä–æ–±–∏ —Ä–µ–¥–∞–≥—É–≤–∞–Ω–Ω—è. –ü–æ–¥–∞–ª—å—à—ñ –∑–º—ñ–Ω–∏ –Ω–µ–º–æ–∂–ª–∏–≤—ñ.
            </div>
            {% endif %}
            
            <form method="POST" action="/listing/{{ listing.id }}/edit">
                <div class="form-group">
                    <label>–ú–∞—Ä–∫–∞ *</label>
                    <select name="brand_id" id="brand_id" required onchange="loadModels()">
                        <option value="">–û–±–µ—Ä—ñ—Ç—å –º–∞—Ä–∫—É</option>
                        {% for brand in brands %}
                        <option value="{{ brand.id }}" {% if listing.brandId == brand.id %}selected{% endif %}>
                            {{ brand.name }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–ú–æ–¥–µ–ª—å *</label>
                    <select name="model_id" id="model_id" required>
                        <option value="">–°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å –º–∞—Ä–∫—É</option>
                    </select>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>–†—ñ–∫ –≤–∏–ø—É—Å–∫—É *</label>
                        <input type="number" name="year" min="1900" max="2025" value="{{ listing.year }}" required>
                    </div>
                    <div class="form-group">
                        <label>–ü—Ä–æ–±—ñ–≥ (–∫–º) *</label>
                        <input type="number" name="mileage" min="0" value="{{ listing.mileage }}" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>–¶—ñ–Ω–∞ *</label>
                        <input type="number" name="price" step="0.01" min="0" value="{{ listing.price }}" required>
                    </div>
                    <div class="form-group">
                        <label>–í–∞–ª—é—Ç–∞ *</label>
                        <select name="currency" required>
                            <option value="UAH" {% if listing.currency == 'UAH' %}selected{% endif %}>UAH</option>
                            <option value="USD" {% if listing.currency == 'USD' %}selected{% endif %}>USD</option>
                            <option value="EUR" {% if listing.currency == 'EUR' %}selected{% endif %}>EUR</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-group">
                    <label>–†–µ–≥—ñ–æ–Ω *</label>
                    <select name="region" required>
                        <option value="">–û–±–µ—Ä—ñ—Ç—å —Ä–µ–≥—ñ–æ–Ω</option>
                        <option value="–ö–∏—ó–≤" {% if listing.region == '–ö–∏—ó–≤' %}selected{% endif %}>–ö–∏—ó–≤</option>
                        <option value="–ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ö–∏—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–õ—å–≤—ñ–≤" {% if listing.region == '–õ—å–≤—ñ–≤' %}selected{% endif %}>–õ—å–≤—ñ–≤</option>
                        <option value="–õ—å–≤—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–õ—å–≤—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–õ—å–≤—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–û–¥–µ—Å–∞" {% if listing.region == '–û–¥–µ—Å–∞' %}selected{% endif %}>–û–¥–µ—Å–∞</option>
                        <option value="–û–¥–µ—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–û–¥–µ—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–û–¥–µ—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–•–∞—Ä–∫—ñ–≤" {% if listing.region == '–•–∞—Ä–∫—ñ–≤' %}selected{% endif %}>–•–∞—Ä–∫—ñ–≤</option>
                        <option value="–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–•–∞—Ä–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–î–Ω—ñ–ø—Ä–æ" {% if listing.region == '–î–Ω—ñ–ø—Ä–æ' %}selected{% endif %}>–î–Ω—ñ–ø—Ä–æ</option>
                        <option value="–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–î–Ω—ñ–ø—Ä–æ–ø–µ—Ç—Ä–æ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–ó–∞–ø–æ—Ä—ñ–∂–∂—è" {% if listing.region == '–ó–∞–ø–æ—Ä—ñ–∂–∂—è' %}selected{% endif %}>–ó–∞–ø–æ—Ä—ñ–∂–∂—è</option>
                        <option value="–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ó–∞–ø–æ—Ä—ñ–∑—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–í—ñ–Ω–Ω–∏—Ü—è" {% if listing.region == '–í—ñ–Ω–Ω–∏—Ü—è' %}selected{% endif %}>–í—ñ–Ω–Ω–∏—Ü—è</option>
                        <option value="–í—ñ–Ω–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–í—ñ–Ω–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–í—ñ–Ω–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–ñ–∏—Ç–æ–º–∏—Ä" {% if listing.region == '–ñ–∏—Ç–æ–º–∏—Ä' %}selected{% endif %}>–ñ–∏—Ç–æ–º–∏—Ä</option>
                        <option value="–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ñ–∏—Ç–æ–º–∏—Ä—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫" {% if listing.region == '–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫' %}selected{% endif %}>–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫</option>
                        <option value="–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–Ü–≤–∞–Ω–æ-–§—Ä–∞–Ω–∫—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–ö—Ä–æ–ø–∏–≤–Ω–∏—Ü—å–∫–∏–π" {% if listing.region == '–ö—Ä–æ–ø–∏–≤–Ω–∏—Ü—å–∫–∏–π' %}selected{% endif %}>–ö—Ä–æ–ø–∏–≤–Ω–∏—Ü—å–∫–∏–π</option>
                        <option value="–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ö—ñ—Ä–æ–≤–æ–≥—Ä–∞–¥—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–õ—É—Ü—å–∫" {% if listing.region == '–õ—É—Ü—å–∫' %}selected{% endif %}>–õ—É—Ü—å–∫</option>
                        <option value="–í–æ–ª–∏–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–í–æ–ª–∏–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–í–æ–ª–∏–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–ú–∏–∫–æ–ª–∞—ó–≤" {% if listing.region == '–ú–∏–∫–æ–ª–∞—ó–≤' %}selected{% endif %}>–ú–∏–∫–æ–ª–∞—ó–≤</option>
                        <option value="–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ú–∏–∫–æ–ª–∞—ó–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–ü–æ–ª—Ç–∞–≤–∞" {% if listing.region == '–ü–æ–ª—Ç–∞–≤–∞' %}selected{% endif %}>–ü–æ–ª—Ç–∞–≤–∞</option>
                        <option value="–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ü–æ–ª—Ç–∞–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–†—ñ–≤–Ω–µ" {% if listing.region == '–†—ñ–≤–Ω–µ' %}selected{% endif %}>–†—ñ–≤–Ω–µ</option>
                        <option value="–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–†—ñ–≤–Ω–µ–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–°—É–º–∏" {% if listing.region == '–°—É–º–∏' %}selected{% endif %}>–°—É–º–∏</option>
                        <option value="–°—É–º—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–°—É–º—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–°—É–º—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–¢–µ—Ä–Ω–æ–ø—ñ–ª—å" {% if listing.region == '–¢–µ—Ä–Ω–æ–ø—ñ–ª—å' %}selected{% endif %}>–¢–µ—Ä–Ω–æ–ø—ñ–ª—å</option>
                        <option value="–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–¢–µ—Ä–Ω–æ–ø—ñ–ª—å—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–£–∂–≥–æ—Ä–æ–¥" {% if listing.region == '–£–∂–≥–æ—Ä–æ–¥' %}selected{% endif %}>–£–∂–≥–æ—Ä–æ–¥</option>
                        <option value="–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ó–∞–∫–∞—Ä–ø–∞—Ç—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π" {% if listing.region == '–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π' %}selected{% endif %}>–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∏–π</option>
                        <option value="–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–•–º–µ–ª—å–Ω–∏—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–ß–µ—Ä–∫–∞—Å–∏" {% if listing.region == '–ß–µ—Ä–∫–∞—Å–∏' %}selected{% endif %}>–ß–µ—Ä–∫–∞—Å–∏</option>
                        <option value="–ß–µ—Ä–∫–∞—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ß–µ—Ä–∫–∞—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ß–µ—Ä–∫–∞—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–ß–µ—Ä–Ω—ñ–≤—Ü—ñ" {% if listing.region == '–ß–µ—Ä–Ω—ñ–≤—Ü—ñ' %}selected{% endif %}>–ß–µ—Ä–Ω—ñ–≤—Ü—ñ</option>
                        <option value="–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ß–µ—Ä–Ω—ñ–≤–µ—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–ß–µ—Ä–Ω—ñ–≥—ñ–≤" {% if listing.region == '–ß–µ—Ä–Ω—ñ–≥—ñ–≤' %}selected{% endif %}>–ß–µ—Ä–Ω—ñ–≥—ñ–≤</option>
                        <option value="–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–ß–µ—Ä–Ω—ñ–≥—ñ–≤—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–î–æ–Ω–µ—Ü—å–∫" {% if listing.region == '–î–æ–Ω–µ—Ü—å–∫' %}selected{% endif %}>–î–æ–Ω–µ—Ü—å–∫</option>
                        <option value="–î–æ–Ω–µ—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–î–æ–Ω–µ—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–î–æ–Ω–µ—Ü—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–õ—É–≥–∞–Ω—Å—å–∫" {% if listing.region == '–õ—É–≥–∞–Ω—Å—å–∫' %}selected{% endif %}>–õ—É–≥–∞–Ω—Å—å–∫</option>
                        <option value="–õ—É–≥–∞–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å" {% if listing.region == '–õ—É–≥–∞–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å' %}selected{% endif %}>–õ—É–≥–∞–Ω—Å—å–∫–∞ –æ–±–ª–∞—Å—Ç—å</option>
                        <option value="–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å" {% if listing.region == '–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å' %}selected{% endif %}>–°–µ–≤–∞—Å—Ç–æ–ø–æ–ª—å</option>
                        <option value="–ê–† –ö—Ä–∏–º" {% if listing.region == '–ê–† –ö—Ä–∏–º' %}selected{% endif %}>–ê–† –ö—Ä–∏–º</option>
                    </select>
                </div>
                
                <div class="form-group">
                    <label>–û–ø–∏—Å *</label>
                    <textarea name="description" required>{{ listing.description }}</textarea>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>–¢–∏–ø –ø–∞–ª–∏–≤–∞</label>
                        <select name="fuel_type">
                            <option value="">–ù–µ –≤–∫–∞–∑–∞–Ω–æ</option>
                            <option value="petrol" {% if listing.get('fuelType') == 'petrol' %}selected{% endif %}>–ë–µ–Ω–∑–∏–Ω</option>
                            <option value="diesel" {% if listing.get('fuelType') == 'diesel' %}selected{% endif %}>–î–∏–∑–µ–ª—å</option>
                            <option value="electric" {% if listing.get('fuelType') == 'electric' %}selected{% endif %}>–ï–ª–µ–∫—Ç—Ä–∏–∫–∞</option>
                            <option value="hybrid" {% if listing.get('fuelType') == 'hybrid' %}selected{% endif %}>–ì—ñ–±—Ä–∏–¥</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ö–æ—Ä–æ–±–∫–∞ –ø–µ—Ä–µ–¥–∞—á</label>
                        <select name="transmission">
                            <option value="">–ù–µ –≤–∫–∞–∑–∞–Ω–æ</option>
                            <option value="manual" {% if listing.get('transmission') == 'manual' %}selected{% endif %}>–ú–µ—Ö–∞–Ω—ñ—á–Ω–∞</option>
                            <option value="automatic" {% if listing.get('transmission') == 'automatic' %}selected{% endif %}>–ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∞</option>
                            <option value="robot" {% if listing.get('transmission') == 'robot' %}selected{% endif %}>–†–æ–±–æ—Ç</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>–ö–æ–ª—ñ—Ä</label>
                        <input type="text" name="color" value="{{ listing.get('color', '') }}" placeholder="–ù–∞–ø—Ä–∏–∫–ª–∞–¥: –ß–æ—Ä–Ω–∏–π">
                    </div>
                    <div class="form-group">
                        <label>–¢–∏–ø –∫—É–∑–æ–≤–∞</label>
                        <select name="body_type">
                            <option value="">–ù–µ –≤–∫–∞–∑–∞–Ω–æ</option>
                            <option value="sedan" {% if listing.get('bodyType') == 'sedan' %}selected{% endif %}>–°–µ–¥–∞–Ω</option>
                            <option value="hatchback" {% if listing.get('bodyType') == 'hatchback' %}selected{% endif %}>–•–µ—Ç—á–±–µ–∫</option>
                            <option value="suv" {% if listing.get('bodyType') == 'suv' %}selected{% endif %}>SUV</option>
                            <option value="coupe" {% if listing.get('bodyType') == 'coupe' %}selected{% endif %}>–ö—É–ø–µ</option>
                            <option value="wagon" {% if listing.get('bodyType') == 'wagon' %}selected{% endif %}>–£–Ω—ñ–≤–µ—Ä—Å–∞–ª</option>
                            <option value="van" {% if listing.get('bodyType') == 'van' %}selected{% endif %}>–§—É—Ä–≥–æ–Ω</option>
                        </select>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>–û–±'—î–º –¥–≤–∏–≥—É–Ω–∞ (–ª)</label>
                        <input type="number" name="engine_volume" step="0.1" min="0" value="{{ listing.get('engineVolume', 0) }}" placeholder="2.0">
                    </div>
                    <div class="form-group">
                        <label>–ü–æ—Ç—É–∂–Ω—ñ—Å—Ç—å (–∫.—Å.)</label>
                        <input type="number" name="engine_power" min="0" value="{{ listing.get('enginePower', 0) }}" placeholder="150">
                    </div>
                </div>
                
                <div class="form-group">
                    <label>–ö—ñ–ª—å–∫—ñ—Å—Ç—å –¥–≤–µ—Ä–µ–π</label>
                    <select name="doors_count">
                        <option value="">–ù–µ –≤–∫–∞–∑–∞–Ω–æ</option>
                        <option value="2" {% if listing.get('doorsCount') == 2 %}selected{% endif %}>2</option>
                        <option value="3" {% if listing.get('doorsCount') == 3 %}selected{% endif %}>3</option>
                        <option value="4" {% if listing.get('doorsCount') == 4 %}selected{% endif %}>4</option>
                        <option value="5" {% if listing.get('doorsCount') == 5 %}selected{% endif %}>5</option>
                    </select>
                </div>
                
                <div style="display: flex; gap: 10px; margin-top: 20px;">
                    <button type="submit" class="btn btn-primary" {% if listing.editCount >= 3 %}disabled{% endif %}>
                        –ó–±–µ—Ä–µ–≥—Ç–∏ –∑–º—ñ–Ω–∏
                    </button>
                    <a href="/listing/{{ listing.id }}" class="btn btn-secondary">–°–∫–∞—Å—É–≤–∞—Ç–∏</a>
                </div>
            </form>
        </div>
    </div>

    <script>
        function loadModels() {
            const brandId = document.getElementById('brand_id').value;
            const modelSelect = document.getElementById('model_id');
            modelSelect.innerHTML = '<option value="">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</option>';
            
            if (!brandId) {
                modelSelect.innerHTML = '<option value="">–°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä—ñ—Ç—å –º–∞—Ä–∫—É</option>';
                return;
            }
            
            fetch(`/api/brands/${brandId}/models`)
                .then(response => response.json())
                .then(models => {
                    modelSelect.innerHTML = '<option value="">–û–±–µ—Ä—ñ—Ç—å –º–æ–¥–µ–ª—å</option>';
                    models.forEach(model => {
                        const option = document.createElement('option');
                        option.value = model.id;
                        option.textContent = model.name;
                        {% if listing.modelId %}
                        if (model.id == {{ listing.modelId }}) {
                            option.selected = true;
                        }
                        {% endif %}
                        modelSelect.appendChild(option);
                    });
                })
                .catch(error => {
                    console.error('Error loading models:', error);
                    modelSelect.innerHTML = '<option value="">–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è</option>';
                });
        }
        
        // –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ –º–æ–¥–µ–ª—ñ –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        window.onload = function() {
            const brandId = document.getElementById('brand_id').value;
            if (brandId) {
                loadModels();
            }
        };
    </script>
</body>
</html>

